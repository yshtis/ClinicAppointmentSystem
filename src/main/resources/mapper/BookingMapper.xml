<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.unknownclinic.appointment.repository.BookingMapper">

  <!-- 予約一覧を取得（ユーザー名・診察券番号・時間帯も含めて） -->
  <select id="findAllBookingsWithUserAndTime" resultType="com.unknownclinic.appointment.dto.BookingListItem">
    SELECT
      b.id AS bookingId,
      b.date AS date,
      t.start_time AS startTime,
      t.end_time AS endTime,
      u.name AS userName,
      u.card_number AS cardNumber,
      b.status AS status
    FROM bookings b
    JOIN users u ON b.user_id = u.id
    JOIN time_slots t ON b.time_slot_id = t.id
    ORDER BY b.date DESC, t.start_time
  </select>

  <!-- 必要に応じて他のSQLもここに追記 -->

</mapper>