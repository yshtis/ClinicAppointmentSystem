<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{parts/common :: html_head('診断予約 - さわやか医院予約システム')}"></head>
<link rel="stylesheet" th:href="@{/css/parts/main.css}">
<body>
	<header th:replace="~{parts/common :: header()}"></header>
	<div class="container py-4">
		<div class="row justify-content-center">
			<!-- カード風パネル -->
			<div class="col-12 col-md-10 col-lg-8">
				<div class="row g-0 shadow-sm"
					style="border-radius: 1.5rem; overflow: hidden; background: #fff;">
					<!-- タイトル行 -->
					<div class="col-12">
						<h2 class="mb-0 py-3 text-center" style="font-weight: bold;">予約時間を選択</h2>
						<hr class="my-0">
					</div>
					<!-- 営業日選択フォーム -->
					<div class="col-md-6 border-end" style="background: #f9fbfe;">
						<div
							class="p-4 h-100 d-flex flex-column gap-3 flex-grow-1 text-center">
							<label class="form-label mb-3">営業日を選択：</label>
							<div class="d-flex flex-column gap-3 flex-grow-1">
								<a th:each="day, iter : ${businessDays}"
									th:href="@{/main(businessDayId=${day.id})}"
									th:text="${#temporals.format(day.businessDate, 'yyyy/MM/dd (E)', 'Asia/Tokyo')}"
									th:classappend="${day.id == selectedBusinessDayId} ? 'btn btn-primary' : 'btn btn-outline-primary'"
									class="btn w-75 py-2 mx-auto" style="margin-bottom: 6px;"
									th:styleappend="${iter.last} ? 'margin-bottom:0;' : ''"> </a>
							</div>
						</div>
					</div>
					<!-- 時間枠選択フォーム -->
					<div
						class="col-md-6 d-flex align-items-center justify-content-center"
						style="padding: 2rem;">
						<div th:if="${selectedBusinessDayId != null}">
							<label class="form-label mb-3">予約時間を選択：</label>
							<form th:action="@{/confirm}" method="get">
								<input type="hidden" name="businessDayId"
									th:value="${selectedBusinessDayId}" />
								<div th:each="slot : ${allTimeSlots}">
									<span th:text="${slot.label}"></span>
									<button type="submit" name="businessDaySlotId"
										th:value="${slot.id}" th:text="'選択'"
										th:classappend="${bookedSlotIds.contains(slot.id) ? 'btn btn-secondary disabled' : 'btn btn-primary'}"
										th:disabled="${bookedSlotIds.contains(slot.id)}"
										style="margin-bottom: 3px;"></button>
								</div>
							</form>
						</div>
						<div th:unless="${selectedBusinessDayId != null}"
							class="h-100 d-flex align-items-center justify-content-center"
							style="min-height: 200px;">
							<span class="text-secondary">営業日を選択してください</span>
						</div>
					</div>
				</div>
			</div>
			<!-- /col -->
		</div>
		<!-- /row -->
	</div>
	<footer th:replace="~{parts/common :: footer()}"></footer>
</body>
</html>