<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{parts/common :: html_head('マイページ - さわやか医院予約システム')}"></head>
<body>
	<header th:replace="~{parts/common :: header()}"></header>
	<div class="container py-4">
		<h2 class="mb-4" th:text="'マイページ - ' + ${user.name} + ' さん'"></h2>

		<!-- 予約画面（main）へのリンク -->
		<div class="mb-4 text-end">
			<a href="/main" class="btn btn-outline-primary"> <i
				class="bi bi-arrow-left"></i> 予約画面に戻る
			</a>
		</div>

		<div class="row g-4">
			<!-- 未来の予約 -->
			<div class="col-12 col-lg-6">
				<div class="card shadow-sm">
					<div class="card-header bg-primary text-white">現在の予約</div>
					<div class="card-body">
						<div th:if="${#lists.isEmpty(futureBookings)}">
							<p class="text-secondary">現在の予約はありません。</p>
						</div>
						<table class="table" th:if="${!#lists.isEmpty(futureBookings)}">
							<thead>
								<tr>
									<th>日付</th>
									<th>時間</th>
									<th>状態</th>
									<th></th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="booking : ${futureBookings}">
									<td
										th:text="${#temporals.format(booking.date, 'yyyy/MM/dd (E)', 'Asia/Tokyo')}"></td>
									<td
										th:text="${@bookingServiceImpl.SLOT_TIME_LABELS[booking.timeSlotId]}"></td>
									<td
										th:text="${booking.status == null or booking.status == 'reserved' ? '予約済み' : (booking.status == 'canceled' ? 'キャンセル済み' : booking.status)}"></td>
									<td>
										<form th:action="@{/mypage/cancel}" method="post"
											th:if="${booking.status == null or booking.status == 'reserved'}">
											<input type="hidden" name="bookingId"
												th:value="${booking.id}" />
											<button type="submit" class="btn btn-danger btn-sm"
												onclick="return confirm('本当にキャンセルしますか？');">キャンセル</button>
										</form>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
			<!-- 過去の予約 -->
			<div class="col-12 col-lg-6">
				<div class="card shadow-sm">
					<div class="card-header bg-secondary text-white">予約履歴</div>
					<div class="card-body">
						<div th:if="${#lists.isEmpty(pastBookings)}">
							<p class="text-secondary">過去の予約履歴はありません。</p>
						</div>
						<table class="table" th:if="${!#lists.isEmpty(pastBookings)}">
							<thead>
								<tr>
									<th>日付</th>
									<th>時間</th>
									<th>状態</th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="booking : ${pastBookings}">
									<td
										th:text="${#temporals.format(booking.date, 'yyyy/MM/dd (E)', 'Asia/Tokyo')}"></td>
									<td
										th:text="${@bookingServiceImpl.SLOT_TIME_LABELS[booking.timeSlotId]}"></td>
									<td
										th:text="${booking.status == null or booking.status == 'reserved' ? '予約済み' : (booking.status == 'canceled' ? 'キャンセル済み' : booking.status)}"></td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>
	<footer th:replace="~{parts/common :: footer()}"></footer>
</body>
</html>